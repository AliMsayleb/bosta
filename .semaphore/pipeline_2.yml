version: v1.0
name: Pipeline 2
blocks:
  - name: Deploy
    task:
      jobs:
        - name: 'Job #1'
          commands:
            - checkout
            - ssh-keyscan -H -p 22 $REMOTE_IP_ADDRESS >> ~/.ssh/known_hosts
            - printf "Host $REMOTE_IP_ADDRESS\n  HostName REMOTE_IP_ADDRESS\n  User git\n  IdentityFile ~/.ssh/menadevs_bosta_do\n" >> ~/.ssh/config
            - 'git remote add prod root@$REMOTE_IP_ADDRESS:/root/repos/bosta-remote'
            - git push origin prod master
      env_vars:
        - name: REMOTE_IP_ADDRESS
          value: 178.62.31.50
        - name: REMOTE_URL
          value: root@178.62.31.50/root/repos/bosta-remote
      secrets:
        - name: Bosta
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
